function M = M_kuka(parms_, q_)
  q = @(n)q_(n+1);
  parms = @(n)parms_(n+1);
  
  x0 = sin(q(1));
  x1 = cos(q(1));
  x2 = cos(q(2));
  x3 = x0*x2;
  x4 = -x1;
  x5 = sin(q(2));
  x6 = x0*x5;
  x7 = -x6;
  x8 = -0.42*x3;
  x9 = cos(q(3));
  x10 = sin(q(3));
  x11 = x10*x4 + x3*x9;
  x12 = -x9;
  x13 = x10*x3 + x12*x4;
  x14 = -0.42*x6;
  x15 = x10*x14;
  x16 = cos(q(4));
  x17 = x11*x16;
  x18 = sin(q(4));
  x19 = x18*x7;
  x20 = x17 + x19;
  x21 = x11*x18;
  x22 = x16*x7;
  x23 = x21 - x22;
  x24 = x14*x9;
  x25 = -x8;
  x26 = x16*x25 + 0.4*x17 + x18*x24 + 0.4*x19;
  x27 = sin(q(5));
  x28 = cos(q(5));
  x29 = x13*x27 + x20*x28;
  x30 = -x23;
  x31 = -x27;
  x32 = x13*x28 + x20*x31;
  x33 = x16*x24 + x18*x8 - 0.4*x21 + 0.4*x22;
  x34 = x15*x28 + x31*x33;
  x35 = cos(q(6));
  x36 = x29*x35;
  x37 = sin(q(6));
  x38 = x30*x37;
  x39 = x36 + x38;
  x40 = x30*x35;
  x41 = x29*x37;
  x42 = x40 - x41;
  x43 = -parms(80);
  x44 = -x26;
  x45 = -x37;
  x46 = x15*x27 + x28*x33;
  x47 = x35*x44 - 0.126*x36 - 0.126*x38 + x45*x46;
  x48 = parms(72)*x39 + parms(73)*x42 + parms(74)*x32 + parms(79)*x34 + x43*x47;
  x49 = -parms(68);
  x50 = x35*x46 + x37*x44 + 0.126*x40 - 0.126*x41;
  x51 = -parms(78);
  x52 = parms(73)*x39 + parms(75)*x42 + parms(76)*x32 + parms(80)*x50 + x34*x51;
  x53 = parms(78)*x32 + parms(81)*x47 + x39*x43;
  x54 = -0.126*x53;
  x55 = -parms(79);
  x56 = parms(80)*x42 + parms(81)*x50 + x32*x55;
  x57 = x37*x56;
  x58 = parms(60)*x29 + parms(61)*x30 + parms(62)*x32 + parms(67)*x34 + x35*x48 + x35*x54 + x44*x49 + x45*x52 - 0.126*x57;
  x59 = -parms(56);
  x60 = -parms(67);
  x61 = parms(74)*x39 + parms(76)*x42 + parms(77)*x32 + parms(78)*x47 + x50*x55;
  x62 = parms(62)*x29 + parms(64)*x30 + parms(65)*x32 + parms(66)*x44 + x46*x60 + x61;
  x63 = parms(48)*x20 + parms(49)*x13 + parms(50)*x23 + parms(55)*x26 + x15*x59 + x28*x58 + x31*x62;
  x64 = -parms(66);
  x65 = x35*x56;
  x66 = -parms(61)*x29 - parms(63)*x30 - parms(64)*x32 - parms(68)*x46 - x34*x64 - x35*x52 - x37*x48 - x37*x54 - 0.126*x65;
  x67 = -parms(55);
  x68 = parms(50)*x20 + parms(52)*x13 + parms(53)*x23 + parms(54)*x15 + x33*x67 + x66;
  x69 = -x13;
  x70 = parms(54)*x69 + parms(55)*x20 + parms(57)*x26 - parms(66)*x32 - parms(69)*x44 - x29*x49 - x35*x53 - x57;
  x71 = 0.4*x16;
  x72 = parms(68)*x30 + parms(69)*x46 + x32*x60 + x45*x53 + x65;
  x73 = parms(67)*x29 + parms(69)*x34 + parms(79)*x39 + parms(81)*x34 + x30*x64 + x42*x51;
  x74 = parms(55)*x30 + parms(56)*x13 + parms(57)*x33 + x28*x72 + x31*x73;
  x75 = x18*x74;
  x76 = parms(36)*x11 + parms(37)*x7 + parms(38)*x13 + parms(43)*x15 + parms(44)*x25 + x16*x63 + x18*x68 + x70*x71 - 0.4*x75;
  x77 = parms(49)*x20 + parms(51)*x13 + parms(52)*x23 + parms(54)*x44 + parms(56)*x33 + x27*x58 + x28*x62;
  x78 = -parms(43);
  x79 = parms(38)*x11 + parms(40)*x7 + parms(41)*x13 + parms(42)*x8 + x24*x78 + x77;
  x80 = parms(24)*x3 + parms(25)*x4 + parms(26)*x7 + parms(31)*x8 + x10*x79 + x76*x9;
  x81 = -parms(42);
  x82 = -x16;
  x83 = x18*x70;
  x84 = parms(37)*x11 + parms(39)*x7 + parms(40)*x13 + parms(44)*x24 + x15*x81 + x18*x63 + x68*x82 + x71*x74 + 0.4*x83;
  x85 = -parms(31);
  x86 = parms(26)*x3 + parms(28)*x4 + parms(29)*x7 + x14*x85 + x84;
  x87 = -x5;
  x88 = parms(32)*x4 + parms(33)*x14 + x10*(parms(43)*x11 + parms(45)*x15 + parms(54)*x23 + parms(57)*x15 + x20*x59 + x27*x72 + x28*x73 + x7*x81) + x7*x85 + x9*(parms(43)*x69 + parms(44)*x7 + parms(45)*x24 + x16*x74 + x83);
  x89 = -0.42*x5;
  x90 = -parms(44);
  x91 = -parms(30);
  x92 = parms(31)*x3 + parms(33)*x8 + parms(42)*x13 + parms(45)*x8 + x11*x90 + x4*x91 + x70*x82 + x75;
  x93 = -parms(25)*x3 - parms(27)*x4 - parms(28)*x7 - parms(30)*x25 - parms(32)*x14 - x10*x76 - x12*x79;
  x94 = -parms(13)*x0 - parms(16)*x1 - x2*x86 - 0.42*x2*x88 - x5*x80 - x89*x92;
  x95 = -x2;
  x96 = 0.42*x5;
  x97 = x87*x9;
  x98 = x10*x87;
  x99 = -0.42*x2;
  x100 = x10*x99;
  x101 = x18*x95;
  x102 = x101 + x16*x97;
  x103 = x18*x97;
  x104 = x103 + x82*x95;
  x105 = x9*x99;
  x106 = 0.4*x101 + x105*x18 + x71*x97 + x82*x96;
  x107 = x102*x28 + x27*x98;
  x108 = -x104;
  x109 = x102*x31 + x28*x98;
  x110 = -0.4*x103 + x105*x16 + x18*x96 + x71*x95;
  x111 = x100*x28 + x110*x31;
  x112 = x107*x35;
  x113 = x108*x37;
  x114 = x112 + x113;
  x115 = x108*x35;
  x116 = x107*x45 + x115;
  x117 = -x106;
  x118 = x100*x27 + x110*x28;
  x119 = -0.126*x112 - 0.126*x113 + x117*x35 + x118*x45;
  x120 = parms(72)*x114 + parms(73)*x116 + parms(74)*x109 + parms(79)*x111 + x119*x43;
  x121 = -0.126*x37;
  x122 = x107*x121 + 0.126*x115 + x117*x37 + x118*x35;
  x123 = parms(73)*x114 + parms(75)*x116 + parms(76)*x109 + parms(80)*x122 + x111*x51;
  x124 = parms(80)*x116 + parms(81)*x122 + x109*x55;
  x125 = parms(78)*x109 + parms(81)*x119 + x114*x43;
  x126 = x125*x35;
  x127 = parms(60)*x107 + parms(61)*x108 + parms(62)*x109 + parms(67)*x111 + x117*x49 + x120*x35 + x121*x124 + x123*x45 - 0.126*x126;
  x128 = parms(74)*x114 + parms(76)*x116 + parms(77)*x109 + parms(78)*x119 + x122*x55;
  x129 = parms(62)*x107 + parms(64)*x108 + parms(65)*x109 + parms(66)*x117 + x118*x60 + x128;
  x130 = parms(48)*x102 + parms(49)*x98 + parms(50)*x104 + parms(55)*x106 + x100*x59 + x127*x28 + x129*x31;
  x131 = x124*x35;
  x132 = -parms(61)*x107 - parms(63)*x108 - parms(64)*x109 - parms(68)*x118 - x111*x64 - x120*x37 - x121*x125 - x123*x35 - 0.126*x131;
  x133 = parms(50)*x102 + parms(52)*x98 + parms(53)*x104 + parms(54)*x100 + x110*x67 + x132;
  x134 = -parms(54)*x98 + parms(55)*x102 + parms(57)*x106 - parms(66)*x109 - parms(69)*x117 - x107*x49 - x124*x37 - x126;
  x135 = parms(68)*x108 + parms(69)*x118 + x109*x60 + x125*x45 + x131;
  x136 = parms(67)*x107 + parms(69)*x111 + parms(79)*x114 + parms(81)*x111 + x108*x64 + x116*x51;
  x137 = parms(55)*x108 + parms(56)*x98 + parms(57)*x110 + x135*x28 + x136*x31;
  x138 = x137*x18;
  x139 = parms(36)*x97 + parms(37)*x95 + parms(38)*x98 + parms(43)*x100 + x130*x16 + x133*x18 + x134*x71 - 0.4*x138 + x90*x96;
  x140 = parms(49)*x102 + parms(51)*x98 + parms(52)*x104 + parms(54)*x117 + parms(56)*x110 + x127*x27 + x129*x28;
  x141 = parms(38)*x97 + parms(40)*x95 + parms(41)*x98 + parms(42)*x96 + x105*x78 + x140;
  x142 = x134*x18;
  x143 = parms(37)*x97 + parms(39)*x95 + parms(40)*x98 + parms(44)*x105 + x100*x81 + x130*x18 + x133*x82 + x137*x71 + 0.4*x142;
  x144 = -parms(25)*x87 - parms(28)*x95 - parms(32)*x99 - x10*x139 - x12*x141 - x91*x96;
  x145 = -x10;
  x146 = x145*x16;
  x147 = x145*x18;
  x148 = x145*x71;
  x149 = x146*x28 + x27*x9;
  x150 = -x147;
  x151 = x146*x31 + x28*x9;
  x152 = -0.4*x147;
  x153 = x152*x31;
  x154 = x149*x35;
  x155 = x150*x37 + x154;
  x156 = x150*x35;
  x157 = x149*x45 + x156;
  x158 = -x148;
  x159 = x152*x28;
  x160 = x121*x150 - 0.126*x154 + x158*x35 + x159*x45;
  x161 = parms(72)*x155 + parms(73)*x157 + parms(74)*x151 + parms(79)*x153 + x160*x43;
  x162 = x121*x149 + 0.126*x156 + x158*x37 + x159*x35;
  x163 = parms(73)*x155 + parms(75)*x157 + parms(76)*x151 + parms(80)*x162 + x153*x51;
  x164 = parms(80)*x157 + parms(81)*x162 + x151*x55;
  x165 = parms(78)*x151 + parms(81)*x160 + x155*x43;
  x166 = x165*x35;
  x167 = parms(60)*x149 + parms(61)*x150 + parms(62)*x151 + parms(67)*x153 + x121*x164 + x158*x49 + x161*x35 + x163*x45 - 0.126*x166;
  x168 = parms(74)*x155 + parms(76)*x157 + parms(77)*x151 + parms(78)*x160 + x162*x55;
  x169 = parms(62)*x149 + parms(64)*x150 + parms(65)*x151 + parms(66)*x158 + x159*x60 + x168;
  x170 = parms(48)*x146 + parms(49)*x9 + parms(50)*x147 + parms(55)*x148 + x167*x28 + x169*x31;
  x171 = x164*x35;
  x172 = -parms(61)*x149 - parms(63)*x150 - parms(64)*x151 - parms(68)*x159 - x121*x165 - x153*x64 - x161*x37 - x163*x35 - 0.126*x171;
  x173 = parms(50)*x146 + parms(52)*x9 + parms(53)*x147 + x152*x67 + x172;
  x174 = parms(54)*x12 + parms(55)*x146 + parms(57)*x148 - parms(66)*x151 - parms(69)*x158 - x149*x49 - x164*x37 - x166;
  x175 = parms(56)*x9 + parms(57)*x152 + x147*x67 + x28*(parms(68)*x150 + parms(69)*x159 + x151*x60 + x165*x45 + x171) + x31*(parms(67)*x149 + parms(69)*x153 + parms(79)*x155 + parms(81)*x153 + x150*x64 + x157*x51);
  x176 = parms(49)*x146 + parms(51)*x9 + parms(52)*x147 + parms(54)*x158 + parms(56)*x152 + x167*x27 + x169*x28;
  x177 = parms(37)*x145 + parms(40)*x9 + x170*x18 + x173*x82 + 0.4*x174*x18 + x175*x71;
  x178 = 0.4*x18;
  x179 = x18*x28;
  x180 = -x82;
  x181 = x18*x31;
  x182 = x31*x71;
  x183 = x179*x35;
  x184 = x180*x37 + x183;
  x185 = x180*x35;
  x186 = x179*x45 + x185;
  x187 = -x178;
  x188 = x28*x71;
  x189 = x121*x180 - 0.126*x183 + x187*x35 + x188*x45;
  x190 = parms(72)*x184 + parms(73)*x186 + parms(74)*x181 + parms(79)*x182 + x189*x43;
  x191 = x121*x179 + 0.126*x185 + x187*x37 + x188*x35;
  x192 = parms(73)*x184 + parms(75)*x186 + parms(76)*x181 + parms(80)*x191 + x182*x51;
  x193 = parms(80)*x186 + parms(81)*x191 + x181*x55;
  x194 = parms(78)*x181 + parms(81)*x189 + x184*x43;
  x195 = x194*x35;
  x196 = parms(60)*x179 + parms(61)*x180 + parms(62)*x181 + parms(67)*x182 + x121*x193 + x187*x49 + x190*x35 + x192*x45 - 0.126*x195;
  x197 = parms(74)*x184 + parms(76)*x186 + parms(77)*x181 + parms(78)*x189 + x191*x55;
  x198 = parms(62)*x179 + parms(64)*x180 + parms(65)*x181 + parms(66)*x187 + x188*x60 + x197;
  x199 = x193*x35;
  x200 = -parms(61)*x179 - parms(63)*x180 - parms(64)*x181 - parms(68)*x188 - x121*x194 - x182*x64 - x190*x37 - x192*x35 - 0.126*x199;
  x201 = parms(49)*x18 + parms(52)*x82 + parms(54)*x187 + parms(56)*x71 + x196*x27 + x198*x28;
  x202 = x27*x35;
  x203 = x31*x37;
  x204 = -0.126*x202;
  x205 = parms(72)*x202 + parms(73)*x203 + parms(74)*x28 + x204*x43;
  x206 = x121*x27;
  x207 = parms(73)*x202 + parms(75)*x203 + parms(76)*x28 + parms(80)*x206;
  x208 = parms(80)*x203 + parms(81)*x206 + x28*x55;
  x209 = parms(78)*x28 + parms(81)*x204 + x202*x43;
  x210 = parms(74)*x202 + parms(76)*x203 + parms(77)*x28 + parms(78)*x204 + x206*x55;
  x211 = -parms(61)*x27 - parms(64)*x28 - x121*x209 - x205*x37 - x207*x35 - 0.126*x208*x35;
  x212 = -x35;
  x213 = 0.126*x37;
  x214 = -0.126*x35;
  x215 = parms(74)*x45 + parms(76)*x212 + parms(78)*x213 + x214*x55;

  M(1) = parms(3) + x0*(parms(12)*x0 + parms(14)*x1 + x2*x80 - 0.42*x2*x92 + x86*x87 + x88*x89) + x1*(parms(14)*x0 + parms(17)*x1 + x93);
  M(2) = x94;
  M(3) = x93;
  M(4) = x84;
  M(5) = x77;
  M(6) = x66;
  M(7) = x61;
  M(8) = x94;
  M(9) = parms(15) - x2*(parms(26)*x87 + parms(29)*x95 + x143 + x85*x99) - 0.42*x2*(parms(33)*x99 + x10*(parms(43)*x97 + parms(45)*x100 + parms(54)*x104 + parms(57)*x100 + x102*x59 + x135*x27 + x136*x28 + x81*x95) + x85*x95 + x9*(parms(44)*x95 + parms(45)*x105 + x137*x16 + x142 + x78*x98)) - x5*(parms(24)*x87 + parms(26)*x95 + parms(31)*x96 + x10*x141 + x139*x9) - x89*(parms(31)*x87 + parms(33)*x96 + parms(42)*x98 + parms(45)*x96 + x134*x82 + x138 + x90*x97);
  M(10) = x144;
  M(11) = x143;
  M(12) = x140;
  M(13) = x132;
  M(14) = x128;
  M(15) = x93;
  M(16) = x144;
  M(17) = parms(27) - x10*(parms(36)*x145 + parms(38)*x9 + x16*x170 + x173*x18 + x174*x71 - 0.4*x175*x18) - x12*(parms(38)*x145 + parms(41)*x9 + x176);
  M(18) = x177;
  M(19) = x176;
  M(20) = x172;
  M(21) = x168;
  M(22) = x84;
  M(23) = x143;
  M(24) = x177;
  M(25) = parms(39) + x178*(parms(55)*x18 + parms(57)*x178 - parms(66)*x181 - parms(69)*x187 - x179*x49 - x193*x37 - x195) + x18*(parms(48)*x18 + parms(50)*x82 + parms(55)*x178 + x196*x28 + x198*x31) + x71*(parms(57)*x71 + x28*(parms(68)*x180 + parms(69)*x188 + x181*x60 + x194*x45 + x199) + x31*(parms(67)*x179 + parms(69)*x182 + parms(79)*x184 + parms(81)*x182 + x180*x64 + x186*x51) + x67*x82) + x82*(parms(50)*x18 + parms(53)*x82 + x200 + x67*x71);
  M(26) = x201;
  M(27) = x200;
  M(28) = x197;
  M(29) = x77;
  M(30) = x140;
  M(31) = x176;
  M(32) = x201;
  M(33) = parms(51) + x27*(parms(60)*x27 + parms(62)*x28 + x121*x208 + x205*x35 + x207*x45 - 0.126*x209*x35) + x28*(parms(62)*x27 + parms(65)*x28 + x210);
  M(34) = x211;
  M(35) = x210;
  M(36) = x66;
  M(37) = x132;
  M(38) = x172;
  M(39) = x200;
  M(40) = x211;
  M(41) = parms(63) - x121*(parms(81)*x213 + x43*x45) - 0.126*x35*(parms(80)*x212 + parms(81)*x214) - x35*(parms(73)*x45 + parms(75)*x212 + parms(80)*x214) - x37*(parms(72)*x45 + parms(73)*x212 + x213*x43);
  M(42) = x215;
  M(43) = x61;
  M(44) = x128;
  M(45) = x168;
  M(46) = x197;
  M(47) = x210;
  M(48) = x215;
  M(49) = parms(77);

  M = reshape(M,7,[]);


end