function G = G_kuka(parms_, q_)
  q = @(n)q_(n+1);
  parms = @(n)parms_(n+1);
  
 x0 = sin(q(1));
  x1 = cos(q(1));
  x2 = 9.81*x1;
  x3 = 9.81*x0;
  x4 = sin(q(2));
  x5 = -x4;
  x6 = x3*x5;
  x7 = sin(q(3));
  x8 = cos(q(2));
  x9 = x3*x8;
  x10 = -x2;
  x11 = -x10;
  x12 = cos(q(3));
  x13 = x11*x12 + x7*x9;
  x14 = cos(q(4));
  x15 = x10*x7 + x12*x9;
  x16 = sin(q(4));
  x17 = -x6;
  x18 = x14*x17 + x15*x16;
  x19 = cos(q(5));
  x20 = x14*x15 + x16*x6;
  x21 = sin(q(5));
  x22 = -x21;
  x23 = x13*x19 + x20*x22;
  x24 = cos(q(6));
  x25 = -x18;
  x26 = x13*x21 + x19*x20;
  x27 = sin(q(6));
  x28 = -x27;
  x29 = x24*x25 + x26*x28;
  x30 = parms(79)*x23 - parms(80)*x29;
  x31 = x24*x26 + x25*x27;
  x32 = -x23;
  x33 = parms(78)*x32 + parms(80)*x31;
  x34 = parms(81)*x31;
  x35 = -0.126*x27;
  x36 = parms(81)*x29;
  x37 = x24*x36;
  x38 = parms(67)*x23 - parms(68)*x25 + x24*x30 + x28*x33 + x34*x35 - 0.126*x37;
  x39 = -x13;
  x40 = parms(78)*x29 - parms(79)*x31;
  x41 = parms(66)*x25 - parms(67)*x26 + x40;
  x42 = parms(55)*x18 + parms(56)*x39 + x19*x38 + x22*x41;
  x43 = x24*x34;
  x44 = -parms(66)*x32 - parms(68)*x26 - x24*x33 - x27*x30 - x35*x36 - 0.126*x43;
  x45 = parms(54)*x13 - parms(55)*x20 + x44;
  x46 = parms(57)*x18 - parms(69)*x25 - x27*x34 - x37;
  x47 = 0.4*x14;
  x48 = parms(69)*x26 + x28*x36 + x43;
  x49 = parms(69)*x23 + parms(81)*x23;
  x50 = parms(57)*x20 + x19*x48 + x22*x49;
  x51 = x16*x50;
  x52 = parms(43)*x13 + parms(44)*x17 + x14*x42 + x16*x45 + x46*x47 - 0.4*x51;
  x53 = parms(54)*x25 + parms(56)*x20 + x19*x41 + x21*x38;
  x54 = parms(42)*x6 - parms(43)*x15 + x53;
  x55 = parms(31)*x6 + parms(32)*x11 + x12*x52 + x54*x7;
  x56 = -x14;
  x57 = x16*x46;
  x58 = parms(42)*x39 + parms(44)*x15 + x16*x42 + x45*x56 + x47*x50 + 0.4*x57;
  x59 = parms(30)*x10 - parms(31)*x9 + x58;
  x60 = parms(33)*x9 + x12*(parms(45)*x15 + x14*x50 + x57) + x7*(parms(45)*x13 + parms(57)*x13 + x19*x49 + x21*x48);
  x61 = -0.42*x4;
  x62 = parms(33)*x6 + parms(45)*x6 + x46*x56 + x51;
  x63 = -parms(30)*x17 - parms(32)*x9 + x12*x54 - x52*x7;

  G(1) = x0*(parms(19)*x2 + x5*x59 + x55*x8 + x60*x61 - 0.42*x62*x8) + x1*(-parms(19)*x3 + x63);
  G(2) = -parms(18)*x10 - parms(20)*x3 - x4*x55 - x59*x8 - 0.42*x60*x8 - x61*x62;
  G(3) = x63;
  G(4) = x58;
  G(5) = x53;
  G(6) = x44;
  G(7) = x40;
end